{
  "name": "AI-powered multi-social media post automation: Google Trends & Perplexity AI",
  "nodes": [
    {
      "parameters": {
        "text": "={{ $json[\"choices[0].message.content\"] }}",
        "additionalFields": {}
      },
      "id": "[PLACEHOLDER_UUID_X1]",
      "name": "X1",
      "type": "n8n-nodes-base.twitter",
      "position": [
        432,
        784
      ],
      "typeVersion": 2,
      "credentials": {
        "twitterOAuth2Api": {
          "id": "[PLACEHOLDER_CREDENTIAL_ID_X]",
          "name": "X account 2"
        }
      }
    },
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_FACEBOOK]",
      "name": "Facebook Graph API1",
      "type": "n8n-nodes-base.facebookGraphApi",
      "position": [
        448,
        384
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "[YOUR_GOOGLE_SHEETS_DOCUMENT_ID]",
          "cachedResultUrl": "[YOUR_GOOGLE_SHEETS_URL]",
          "cachedResultName": "LinkedIn Automation"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "[YOUR_GOOGLE_SHEETS_URL]",
          "cachedResultName": "Sheet1"
        },
        "columns": {
          "value": {
            "Topic": "={{ $('Choosing Topic').item.json.message.content }}",
            "Status": "Posted",
            "AI Output": "={{ $json['choices[0].message.content'] }}",
            "Date Posted": "={{ $('Schedule Trigger').item.json.timestamp }}"
          },
          "schema": [
            {
              "id": "Topic",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Topic",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Status",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "AI Output",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "AI Output",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Date Posted",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Date Posted",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "Topic"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_SHEETS]",
      "name": "Google Sheets2",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        656,
        592
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "fieldToSplitOut": "choices[0].message.content",
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_SPLITOUT]",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        208,
        592
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 6
            },
            {
              "triggerAtHour": 18
            }
          ]
        }
      },
      "id": "[PLACEHOLDER_UUID_SCHEDULE1]",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -1488,
        592
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.perplexity.ai/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"sonar-pro\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are a specialized Media Monitor tracking current events in Iran. Your goal is to report on the latest trends regarding human rights, civil resistance, and social suppression. You prioritize accuracy, brevity, and verifiable sources.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Analyze the input. If generic, **search for the latest trending news (last 24h) regarding Iran**, focusing on human rights, civil suppression, or opposition activities.\\n\\nGenerate **exactly one** short text output.\\n\\n**Strict Guidelines:**\\n1. **Length:** The ENTIRE output must be under **200 characters**.\\n2. **Content:** Summarize the most significant recent event or trend clearly.\\n3. **Formatting:** Plain text only. No analysis sections. No citations/links. No separate lines.\\n4. **Mandatory Tags:** You MUST end with: #rezapahlavi #iran\\n\\nInput: {{ $json.message.content }}\"\n    }\n  ]\n}",
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_PERPLEXITY]",
      "name": "Research Topic- Perplexity",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -240,
        592
      ],
      "typeVersion": 4.2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "[PLACEHOLDER_CREDENTIAL_ID_HEADER]",
          "name": "Header Auth account"
        },
        "httpBearerAuth": {
          "id": "[PLACEHOLDER_CREDENTIAL_ID_BEARER]",
          "name": "Bearer Auth account"
        }
      }
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"most-trending\": {\n\n    \"#1\": { \n\n      \"query\":\"{{ $json.related_queries.rising[0].query }}\",\n      \"score\":\"{{ $json.related_queries.rising[0].extracted_value }}\"\n\n    },\n\n\n    \"#2\": { \n\n      \"query\":\"{{ $json.related_queries.rising[1].query }}\",\n      \"score\":\"{{ $json.related_queries.rising[1].extracted_value }}\"\n\n    }\n  }\n}",
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_2TRENDING]",
      "name": "2 Most Trending",
      "type": "n8n-nodes-base.set",
      "position": [
        -1056,
        592
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "jsCode": "// Get the top array from your JSON\nconst topItems = $('Google Trends').first().json.related_queries.top;\n\n// Filter the items to only include those with extracted_value > 30\nconst filtered = topItems.filter(item => item.extracted_value > 30);\n\n// Map the filtered items to their query values and join them with commas\nconst resultString = filtered.map(item => item.query).join(', ');\n\n// Return the result in a new JSON property\nreturn [{ json: { result: resultString } }];\n"
      },
      "id": "[PLACEHOLDER_UUID_KEYWORDS]",
      "name": "High search volume keywords",
      "type": "n8n-nodes-base.code",
      "position": [
        -832,
        592
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-3.5-turbo",
          "cachedResultName": "GPT-3.5-TURBO"
        },
        "messages": {
          "values": [
            {
              {
                "role": "user",
                "content": "Analyze the input. If generic, **search for the latest trending news (last 24h) regarding Iran**, focusing on opposition activities, civil resistance movements, and anti-government protests.\\n\\nGenerate **exactly one** short text output.\\n\\n**Strict Guidelines:**\\n1. **Length:** The ENTIRE output must be under **200 characters**.\\n2. **Content:** Summarize the most significant recent opposition activity or resistance movement clearly.\\n3. **Formatting:** Plain text only. No analysis sections. No citations/links. No separate lines.\\n4. **Mandatory Tags:** You MUST end with: #rezapahlavi #iran\\n\\nInput: {{ $json.message.content }}"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_CHOOSETOPIC]",
      "name": "Choosing Topic",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -608,
        592
      ],
      "typeVersion": 1.8,
      "credentials": {
        "openAiApi": {
          "id": "[PLACEHOLDER_CREDENTIAL_ID_OPENAI]",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Find Trend\n\n",
        "height": 240,
        "width": 400
      },
      "id": "[PLACEHOLDER_UUID_STICKY1]",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1312,
        512
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## High Volume Keywords\n\n",
        "height": 240,
        "width": 200
      },
      "id": "[PLACEHOLDER_UUID_STICKY2]",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -896,
        512
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## Choosing Blog Topic\n\n\n",
        "height": 240,
        "width": 340
      },
      "id": "[PLACEHOLDER_UUID_STICKY3]",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -656,
        512
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## Research\n\n\n",
        "height": 240,
        "width": 600
      },
      "id": "[PLACEHOLDER_UUID_STICKY4]",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -272,
        512
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "url": "https://serpapi.com/search",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "=Iran Protest News"
            },
            {
              "name": "geo",
              "value": "US"
            },
            {
              "name": "hl",
              "value": "en"
            },
            {
              "name": "date",
              "value": "={{ $now.minus({ days: 3 }).format('yyyy-MM-dd') }} {{ $now.format('yyyy-MM-dd') }}"
            },
            {
              "name": "data_type",
              "value": "RELATED_QUERIES"
            },
            {
              "name": "engine",
              "value": "google_trends"
            },
            {
              "name": "api_key",
              "value": "[PLACEHOLDER_API_KEY_SERPAPI]"
            }
          ]
        },
        "options": {}
      },
      "id": "[PLACEHOLDER_UUID_GOOGLETRENDS]",
      "name": "Google Trends",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1280,
        592
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "amount": "={{ Math.round(Math.random() * 20) }}"
      },
      "id": "[PLACEHOLDER_UUID_WAIT]",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "position": [
        -16,
        592
      ],
      "webhookId": "[PLACEHOLDER_WEBHOOK_ID]",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "content": "## Multi Social Media Posting",
        "height": 800
      },
      "id": "[PLACEHOLDER_UUID_STICKY5]",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        368,
        240
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## Status update",
        "height": 260
      },
      "id": "[PLACEHOLDER_UUID_STICKY6]",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        640,
        512
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "authentication": "communityManagement",
        "person": "[CONFIGURE_YOUR_LINKEDIN_PERSON_ID]",
        "text": "={{ $json['choices[0].message.content'] }}",
        "additionalFields": {}
      },
      "id": "[PLACEHOLDER_UUID_LINKEDIN]",
      "name": "LinkedIn1",
      "type": "n8n-nodes-base.linkedIn",
      "position": [
        448,
        592
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "*/5 8-9 * * *"
            },
            {
              "field": "cronExpression",
              "expression": "*/10 18-20 * * *"
            }
          ]
        }
      },
      "id": "[PLACEHOLDER_UUID_SCHEDULE2]",
      "name": "Schedule Trigger1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -464,
        352
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "resource": "image"
      },
      "type": "@mookielianhd/n8n-nodes-instagram.instagram",
      "typeVersion": 1,
      "position": [
        448,
        1008
      ],
      "id": "[PLACEHOLDER_UUID_INSTAGRAM]",
      "name": "Publish"
    }
  ],
  "pinData": {},
  "connections": {
    "Wait": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "X1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Trends": {
      "main": [
        [
          {
            "node": "2 Most Trending",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Choosing Topic": {
      "main": [
        [
          {
            "node": "Research Topic- Perplexity",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2 Most Trending": {
      "main": [
        [
          {
            "node": "High search volume keywords",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Google Trends",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Research Topic- Perplexity": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "High search volume keywords": {
      "main": [
        [
          {
            "node": "Choosing Topic",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LinkedIn1": {
      "main": [
        [
          {
            "node": "Google Sheets2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger1": {
      "main": [
        []
      ]
    },
    "Facebook Graph API1": {
      "main": [
        [
          {
            "node": "Google Sheets2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "[PLACEHOLDER_VERSION_ID]",
  "meta": {
    "templateId": "[PLACEHOLDER_TEMPLATE_ID]",
    "instanceId": "[PLACEHOLDER_INSTANCE_ID]"
  },
  "id": "[PLACEHOLDER_WORKFLOW_ID]",
  "tags": []
}